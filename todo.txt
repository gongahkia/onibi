# Ghostty Menubar - Evolution Audit Tasks
# Generated: 2026-02-09 | Priority: (A) = MVP/Core Vision, (B) = Audit-Suggested
# Tags: +feature, +refactor, +infra, +security, +test


## UNIT TESTING
(B) Create XCTest target GhosttyMenubarTests in Xcode project +test
(B) Write LogFileParserTests: test each log line format (CMD_START, CMD_END, output patterns) +test
(B) Write EventDetectorTests: test AIResponseDetector, TaskCompletionDetector with positive/negative cases +test
(B) Write LogBufferTests: test incremental reading, partial line handling, file rotation detection +test
(B) Write JSONStorageManagerTests: test atomic writes, backup rotation, corrupted file recovery +test
(B) Write LRUCacheTests: test capacity limits, eviction order, thread safety +test
(B) Write FilterRuleTests: test pattern matching for contains, prefix, suffix, regex modes +test
(B) Write SettingsViewModelTests: test persistence, import/export, reset to defaults +test
(B) Write NotificationViewModelTests: test add, dismiss, clearAll, persistence across restarts +test
(B) Create MockEventBus for testing components in isolation without side effects +test
(B) Write ShellHookInstallerTests using temporary directories for rc file modifications +test

## GITHUB ACTIONS CI/CD
(B) Create .github/workflows/ci.yml with macOS-latest runner +infra
(B) Add checkout, setup-xcode steps with Xcode 15+ for Swift 5.9 compatibility +infra
(B) Add step to run xcodebuild test for GhosttyMenubarTests scheme +infra
(B) Add SwiftLint step using swiftlint lint --strict for code quality +infra
(B) Create build step that produces GhosttyMenubar.app bundle +infra
(B) Add artifact upload for built .app bundle on successful builds +infra
(B) Create release workflow triggered on version tags that notarizes and creates GitHub Release +infra
(B) Add branch protection requiring CI pass before merge +infra

## FALSE POSITIVE REDUCTION
(B) Add confidence score (0.0-1.0) to detection results based on pattern specificity +refactor
(B) Implement context window: check lines before/after match for confirming signals +refactor
(B) Create notification deduplication using content hash within 5-second window +refactor
(B) Add "Mark as False Positive" action in notification context menu for user feedback +feature
(B) Store false positive patterns in Settings to auto-suppress in future +feature
(B) Implement adaptive throttling: increase throttle interval if user frequently dismisses same type +feature
(B) Add minimum content length filter to avoid notifications for very short/empty outputs +refactor

